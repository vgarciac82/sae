
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Calendario de Clases - Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
    <style>
        body { padding: 2rem; }
        #calendar { max-width: 1000px; margin: 0 auto; }
    </style>
</head>
<body>

<div class="container">
    <h1 class="mb-4 text-center">Calendario de Clases - DEMO</h1>
    <div class="mb-3 d-flex justify-content-between">
        <div class="w-50 me-2">
            <label class="form-label">Filtrar por Maestro</label>
            <select class="form-select" id="maestroFiltro">
                <option value="">Todos</option>
                <option value="María Torres">María Torres</option>
                <option value="Juan Pérez">Juan Pérez</option>
                <option value="Ana Gómez">Ana Gómez</option>
            </select>
        </div>
        <div class="w-50">
            <label class="form-label">Filtrar por Tipo</label>
            <select class="form-select" id="tipoFiltro">
                <option value="">Todos</option>
                <option value="1:1">1:1</option>
                <option value="2 Alumnos">2 Alumnos</option>
                <option value="3 Alumnos">3 Alumnos</option>
                <option value="4 Alumnos">4 Alumnos</option>
            </select>
        </div>
    </div>
    <div id="calendar"></div>
</div>

<script>
const eventosBase = [
    {
        title: 'Grupo A1 – María Torres',
        start: '2025-08-19T09:00:00',
        end: '2025-08-19T10:00:00',
        extendedProps: {
            maestro: 'María Torres',
            grupo: 'A1',
            alumnos: 3,
            duracion: '60 mins',
            tipo: '1:1'
        }
    },
    {
        title: 'Grupo B2 – Juan Pérez',
        start: '2025-08-20T11:00:00',
        end: '2025-08-20T12:00:00',
        extendedProps: {
            maestro: 'Juan Pérez',
            grupo: 'B2',
            alumnos: 4,
            duracion: '60 mins',
            tipo: '4 Alumnos'
        }
    },
    {
        title: 'Grupo C3 – Ana Gómez',
        start: '2025-08-21T18:00:00',
        end: '2025-08-21T19:30:00',
        extendedProps: {
            maestro: 'Ana Gómez',
            grupo: 'C3',
            alumnos: 2,
            duracion: '90 mins',
            tipo: '3 Alumnos'
        }
    }
];

let calendar;

document.addEventListener('DOMContentLoaded', function () {
    const calendarEl = document.getElementById('calendar');

    calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'timeGridWeek',
        locale: 'es',
        headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay'
        },
        events: eventosBase,
        eventClick: function (info) {
            const { grupo, maestro, alumnos, duracion, tipo } = info.event.extendedProps;
            Swal.fire({
                title: info.event.title,
                html: `
                    <b>Grupo:</b> ${grupo}<br>
                    <b>Maestro:</b> ${maestro}<br>
                    <b>Alumnos:</b> ${alumnos}<br>
                    <b>Duración:</b> ${duracion}<br>
                    <b>Tipo:</b> ${tipo}`,
                icon: 'info',
                showDenyButton: true,
                denyButtonText: 'Cancelar Clase',
                confirmButtonText: 'Cerrar'
            }).then((result) => {
                if (result.isDenied) {
                    Swal.fire({
                        title: 'Cancelando clase...',
                        html: 'Notificando a los alumnos',
                        allowOutsideClick: false,
                        didOpen: () => Swal.showLoading()
                    });

                    setTimeout(() => {
                        info.event.setProp('title', '(Cancelada) ' + info.event.title);
                        info.event.setProp('backgroundColor', '#d9534f');
                        info.event.setProp('borderColor', '#d43f3a');
                        Swal.fire('Clase cancelada', 'Todos los alumnos han sido notificados.', 'success');
                    }, 1000);
                }
            });
        }
    });

    calendar.render();

    $('#maestroFiltro, #tipoFiltro').on('change', function () {
        const maestro = $('#maestroFiltro').val();
        const tipo = $('#tipoFiltro').val();

        const filtrados = eventosBase.filter(e => {
            const matchMaestro = maestro ? e.extendedProps.maestro === maestro : true;
            const matchTipo = tipo ? e.extendedProps.tipo === tipo : true;
            return matchMaestro && matchTipo;
        });

        calendar.removeAllEvents();
        filtrados.forEach(ev => calendar.addEvent(ev));
    });
});
</script>
</body>
</html>
